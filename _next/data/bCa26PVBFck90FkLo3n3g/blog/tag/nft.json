{"pageProps":{"headTitle":"nft posts - idmontie's Portfolio","headKeywords":"nft","tag":"nft","posts":[{"slug":"2023-04-02-dark-emblem-rewrite","date":"2023-04-02","title":"Dark Emblem Rewrite","frontmatter":{"title":"Dark Emblem Rewrite","tags":["dark emblem","wax","nft","blockchain"]},"contentRaw":"\nDark Emblem is an NFT project that was sparked by the idea of combining cards games with Crypto Kitties. You can buy packs, open them to collect random cards, and then use those cards to battle raids with others.\n\nTo support all of the functionality, I created a WAX contract, written in C++, that I deployed to the WAX Blockchain. This contract handled the creation and storage of packs and cards, along with defining an in-game currency DREM.\n\nThere was also a server that would sync with the changes on the Blockchain and provide some additional metadata on top of that. While Blockchains like ETH have stable public APIs that can be used to query data from the Blockchain through 3rd party vendors, WAX does not have the same maturity there. This meant that we would need to proxy requests that would normally be made to a WAX API mode through our servers instead.\n\nI also created a UI application to interact with the server and the Blockchain. The infrastructure ends up looking like:\n\n```mermaid\ngraph LR\n  WAX --> Dfuse\n Dfuse --> Listener(Dark Emblem Listener Service)\n  Listener --> Redis\n  Redis --> API(Dark Emblem API)\n  API --> Dapp\n  WAXEndpoint(WAX Endpoint) --> Dapp\n```\n\nOne of the first steps to interacting with the dapp is to sign in. The authentication flow is similar to an oauth sign in where we let the user sign in with a third party authenticator and then issue a challenge for the user to verify they are who they say they are. At this point we issue a JWT for further API requests.\n\n```mermaid\nsequenceDiagram\n  Dapp->>+3rdPartyAuthenticator: Request sign in\n  3rdPartyAuthenticator->>+Dapp: Wallet name\n  Dapp->>+DarkEmblemAPI: Request nonce\n  DarkEmblemAPI->>+Dapp: Send nonce\n  Dapp->>+3rdPartyAuthenticator: Sign nonce\n  3rdPartyAuthenticator->>+Dapp: Signed nonce\n  Dapp->>+DarkEmblemAPI: Send signed nonce\n  DarkEmblemAPI->>+Dapp: JWT\n```\n\nOnce a user is logged in, they can fully interact with the Dark Emblem WAX contract via the UI. They can purchase packs, open them to get cards, and then use those cards in the Dark Emblem universe. The UI lets users combine Hero cards together to “Ascend” them into a new card. Or they can burn 3 Equipment cards to “Transmogrify” them into a single, better equipment card.\n\nUsers can also participate in Raids, where they stake their cards to defeat an enemy monster – gaining $DREM and XP when they beat the monster.\n\nDapp Schemas and Atomic Assets\n\n```mermaid\nclassDiagram\n  class Card {\n    name: string\n  img: string\n  traits: number[]\n  matronid: number\n  sireid: number\n  rank: number\n  packid: string\n  cardtype: string\n  website: string\n  twitter: string\n  mintedat: number\n  rarity: string\n  cooldown: number\n  xp: number\n  }\n  class Raid {\n  asset_id: number\n  owner: name\n  staked_at: number\n  raid_id: number\n  }\n  class Staked {\n  asset_id: number\n  owner: name\n  staked_at: number\n  raid_id: number\n  }\n\n```\n\nThe Dark Emblem project involves a lot of moving parts, and I’d love to dive deeper into each technical aspect in future blog posts.\n\n## Additional reading\n\n* [Dark Emblem Blog Announcement](https://www.darkemblem.com/blog/post/2023-04-02-new-site-released)\n* [Capsule Cat Announcement](https://capsulecat.com/blog/04-02-2023-dark-emblem-update/)\n","contentHTML":"<p>Dark Emblem is an NFT project that was sparked by the idea of combining cards games with Crypto Kitties. You can buy packs, open them to collect random cards, and then use those cards to battle raids with others.</p>\n<p>To support all of the functionality, I created a WAX contract, written in C++, that I deployed to the WAX Blockchain. This contract handled the creation and storage of packs and cards, along with defining an in-game currency DREM.</p>\n<p>There was also a server that would sync with the changes on the Blockchain and provide some additional metadata on top of that. While Blockchains like ETH have stable public APIs that can be used to query data from the Blockchain through 3rd party vendors, WAX does not have the same maturity there. This meant that we would need to proxy requests that would normally be made to a WAX API mode through our servers instead.</p>\n<p>I also created a UI application to interact with the server and the Blockchain. The infrastructure ends up looking like:</p>\n<mermaid chart=\"graph LR\n  WAX --&gt; Dfuse\n Dfuse --&gt; Listener(Dark Emblem Listener Service)\n  Listener --&gt; Redis\n  Redis --&gt; API(Dark Emblem API)\n  API --&gt; Dapp\n  WAXEndpoint(WAX Endpoint) --&gt; Dapp\"></mermaid>\n<p>One of the first steps to interacting with the dapp is to sign in. The authentication flow is similar to an oauth sign in where we let the user sign in with a third party authenticator and then issue a challenge for the user to verify they are who they say they are. At this point we issue a JWT for further API requests.</p>\n<mermaid chart=\"sequenceDiagram\n  Dapp-&gt;&gt;+3rdPartyAuthenticator: Request sign in\n  3rdPartyAuthenticator-&gt;&gt;+Dapp: Wallet name\n  Dapp-&gt;&gt;+DarkEmblemAPI: Request nonce\n  DarkEmblemAPI-&gt;&gt;+Dapp: Send nonce\n  Dapp-&gt;&gt;+3rdPartyAuthenticator: Sign nonce\n  3rdPartyAuthenticator-&gt;&gt;+Dapp: Signed nonce\n  Dapp-&gt;&gt;+DarkEmblemAPI: Send signed nonce\n  DarkEmblemAPI-&gt;&gt;+Dapp: JWT\"></mermaid>\n<p>Once a user is logged in, they can fully interact with the Dark Emblem WAX contract via the UI. They can purchase packs, open them to get cards, and then use those cards in the Dark Emblem universe. The UI lets users combine Hero cards together to “Ascend” them into a new card. Or they can burn 3 Equipment cards to “Transmogrify” them into a single, better equipment card.</p>\n<p>Users can also participate in Raids, where they stake their cards to defeat an enemy monster – gaining $DREM and XP when they beat the monster.</p>\n<p>Dapp Schemas and Atomic Assets</p>\n<mermaid chart=\"classDiagram\n  class Card {\n    name: string\n  img: string\n  traits: number[]\n  matronid: number\n  sireid: number\n  rank: number\n  packid: string\n  cardtype: string\n  website: string\n  twitter: string\n  mintedat: number\n  rarity: string\n  cooldown: number\n  xp: number\n  }\n  class Raid {\n  asset_id: number\n  owner: name\n  staked_at: number\n  raid_id: number\n  }\n  class Staked {\n  asset_id: number\n  owner: name\n  staked_at: number\n  raid_id: number\n  }\n\"></mermaid>\n<p>The Dark Emblem project involves a lot of moving parts, and I’d love to dive deeper into each technical aspect in future blog posts.</p>\n<h2>Additional reading</h2>\n<ul>\n<li><a href=\"https://www.darkemblem.com/blog/post/2023-04-02-new-site-released\">Dark Emblem Blog Announcement</a></li>\n<li><a href=\"https://capsulecat.com/blog/04-02-2023-dark-emblem-update/\">Capsule Cat Announcement</a></li>\n</ul>","contentCode":"\"use strict\";\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = {\n    a: \"a\",\n    h2: \"h2\",\n    li: \"li\",\n    mermaid: \"mermaid\",\n    p: \"p\",\n    ul: \"ul\",\n    ...props.components\n  };\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.p, {\n      children: \"Dark Emblem is an NFT project that was sparked by the idea of combining cards games with Crypto Kitties. You can buy packs, open them to collect random cards, and then use those cards to battle raids with others.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"To support all of the functionality, I created a WAX contract, written in C++, that I deployed to the WAX Blockchain. This contract handled the creation and storage of packs and cards, along with defining an in-game currency DREM.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"There was also a server that would sync with the changes on the Blockchain and provide some additional metadata on top of that. While Blockchains like ETH have stable public APIs that can be used to query data from the Blockchain through 3rd party vendors, WAX does not have the same maturity there. This meant that we would need to proxy requests that would normally be made to a WAX API mode through our servers instead.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"I also created a UI application to interact with the server and the Blockchain. The infrastructure ends up looking like:\"\n    }), \"\\n\", _jsx(_components.mermaid, {\n      chart: \"graph LR\\n  WAX --> Dfuse\\n Dfuse --> Listener(Dark Emblem Listener Service)\\n  Listener --> Redis\\n  Redis --> API(Dark Emblem API)\\n  API --> Dapp\\n  WAXEndpoint(WAX Endpoint) --> Dapp\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"One of the first steps to interacting with the dapp is to sign in. The authentication flow is similar to an oauth sign in where we let the user sign in with a third party authenticator and then issue a challenge for the user to verify they are who they say they are. At this point we issue a JWT for further API requests.\"\n    }), \"\\n\", _jsx(_components.mermaid, {\n      chart: \"sequenceDiagram\\n  Dapp->>+3rdPartyAuthenticator: Request sign in\\n  3rdPartyAuthenticator->>+Dapp: Wallet name\\n  Dapp->>+DarkEmblemAPI: Request nonce\\n  DarkEmblemAPI->>+Dapp: Send nonce\\n  Dapp->>+3rdPartyAuthenticator: Sign nonce\\n  3rdPartyAuthenticator->>+Dapp: Signed nonce\\n  Dapp->>+DarkEmblemAPI: Send signed nonce\\n  DarkEmblemAPI->>+Dapp: JWT\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Once a user is logged in, they can fully interact with the Dark Emblem WAX contract via the UI. They can purchase packs, open them to get cards, and then use those cards in the Dark Emblem universe. The UI lets users combine Hero cards together to “Ascend” them into a new card. Or they can burn 3 Equipment cards to “Transmogrify” them into a single, better equipment card.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Users can also participate in Raids, where they stake their cards to defeat an enemy monster – gaining $DREM and XP when they beat the monster.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Dapp Schemas and Atomic Assets\"\n    }), \"\\n\", _jsx(_components.mermaid, {\n      chart: \"classDiagram\\n  class Card {\\n    name: string\\n  img: string\\n  traits: number[]\\n  matronid: number\\n  sireid: number\\n  rank: number\\n  packid: string\\n  cardtype: string\\n  website: string\\n  twitter: string\\n  mintedat: number\\n  rarity: string\\n  cooldown: number\\n  xp: number\\n  }\\n  class Raid {\\n  asset_id: number\\n  owner: name\\n  staked_at: number\\n  raid_id: number\\n  }\\n  class Staked {\\n  asset_id: number\\n  owner: name\\n  staked_at: number\\n  raid_id: number\\n  }\\n\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The Dark Emblem project involves a lot of moving parts, and I’d love to dive deeper into each technical aspect in future blog posts.\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Additional reading\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: _jsx(_components.a, {\n          href: \"https://www.darkemblem.com/blog/post/2023-04-02-new-site-released\",\n          children: \"Dark Emblem Blog Announcement\"\n        })\n      }), \"\\n\", _jsx(_components.li, {\n        children: _jsx(_components.a, {\n          href: \"https://capsulecat.com/blog/04-02-2023-dark-emblem-update/\",\n          children: \"Capsule Cat Announcement\"\n        })\n      }), \"\\n\"]\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = props.components || ({});\n  return MDXLayout ? _jsx(MDXLayout, {\n    ...props,\n    children: _jsx(_createMdxContent, {\n      ...props\n    })\n  }) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","excerptRaw":"\nDark Emblem is an NFT project that was sparked by the idea of combining cards games with Crypto Kitties. You can buy packs, open them to collect random cards, and then use those cards to battle raids with others.","excerptHTML":"<p>Dark Emblem is an NFT project that was sparked by the idea of combining cards games with Crypto Kitties. You can buy packs, open them to collect random cards, and then use those cards to battle raids with others.</p>","excerptCode":"\"use strict\";\nconst {jsx: _jsx} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = {\n    p: \"p\",\n    ...props.components\n  };\n  return _jsx(_components.p, {\n    children: \"Dark Emblem is an NFT project that was sparked by the idea of combining cards games with Crypto Kitties. You can buy packs, open them to collect random cards, and then use those cards to battle raids with others.\"\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = props.components || ({});\n  return MDXLayout ? _jsx(MDXLayout, {\n    ...props,\n    children: _jsx(_createMdxContent, {\n      ...props\n    })\n  }) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","tags":["dark emblem","wax","nft","blockchain"]}]},"__N_SSG":true}